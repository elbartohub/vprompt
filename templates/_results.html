{% if prompt_json_str is not none %}
<!-- JSON prompt block only, no debug info -->
{% endif %}
{% if image_url %}
<div>
    <h3 data-en="Uploaded Image:" data-zh="已上傳圖片：">Uploaded Image:</h3>
    <img src="{{ image_url }}" alt="Uploaded Image" style="max-width:300px;">
</div>
{% endif %}
{% if prompt_text is not none %}
<div class="form-card" style="padding: 12px 16px;">
    <h3 data-en="Complete Prompt (Text)" data-zh="完整提示詞（文本）">Complete Prompt (Text)</h3>
    <textarea id="promptTextArea" readonly style="width:100%;height:180px;font-size:0.75em;font-family:monospace;">{{ prompt_text }}</textarea>
    <div class="button-container">
        <button type="button" id="copyTextBtn" class="icon-btn copy-btn" title="Copy All Text"></button>
    </div>
</div>
{% endif %}
{% if prompt_json_str is not none %}
<div class="form-card" style="padding: 12px 16px;">
    <h3 data-en="JSON Prompt (Veo3)" data-zh="JSON 提示詞（Veo3）">JSON Prompt (Veo3)</h3>
    <textarea id="promptJsonArea" style="width:100%;height:140px;font-family:monospace;font-size:0.75em;">{{ prompt_json_str }}</textarea>
    <div class="button-container">
        <button type="button" id="copyJsonBtn" class="icon-btn copy-btn" title="Copy All JSON"></button>
    </div>
</div>

<div class="form-card">
    <div style="width: 100%; margin-top: 12px;">
        <div class="seed-input-container" style="display: block; margin-bottom: 12px; width: 100%;">
            <label for="regenerateSeed" style="font-size: 12px; color: #666; display: block; margin-bottom: 4px;" data-en="Seed:" data-zh="種子：">Seed:</label>
            <input type="number" id="regenerateSeed" name="seed" placeholder="Random" title="Enter a seed value (0-4294967295) for reproducible results, or leave empty for random generation" style="width: 240px; padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; display: block;" min="0" max="4294967295" value="{{ seed if seed is defined and seed is not none else '' }}">
        </div>
        {% if seed is defined and seed is not none %}
        <div style="margin: 8px 0 0 0; font-size: 1em; color: #666;">
            <span data-en="Current Seed:" data-zh="目前種子：">Current Seed:</span> <strong>{{ seed }}</strong>
        </div>
        {% endif %}
        <button type="button" id="regenerateBtn" class="regenerate-btn" style="width: 100%; display: block;" data-en="🔄 Generate Image" data-zh="🔄 生成圖片">🔄 Generate Image</button>
    </div>
</div>
{% if loading %}
<div class="card loading-card">
    <div class="card-header">Generating Image...</div>
    <div class="card-body">
        <span class="loading-palette" aria-label="Loading">🎨</span>
        <span class="loading-text">Please wait while your image is being generated.</span>
    </div>
</div>
{% endif %}
{% endif %}
{% if generated_images and generated_images.success and generated_images.images %}
<div>
    <h2 data-en="Generated Images ({{ generated_images.images_count }})" data-zh="生成的圖片 ({{ generated_images.images_count }})">Generated Images ({{ generated_images.images_count }})</h2>
    <div class="generated-images-gallery">
        {% for image in generated_images.images %}
        <div class="generated-image-item">
            <img src="{{ image.url }}" alt="Generated image" class="generated-image-preview" onclick="openImageModal('{{ image.url }}', '{{ image.filename }}')">
            <div class="image-filename">{{ image.filename }}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
