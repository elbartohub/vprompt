<!DOCTYPE html>
<html lang="en" data-lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="vPrompt - Image/Video Prompt Generator" data-zh="vPrompt - ÂúñÁâá/ÂΩ±ÁâáÊèêÁ§∫Ë©ûÁîüÊàêÂô®">vPrompt - Image/Video Prompt Generator</title>
    <link rel="stylesheet" href="/static/style.css?v=1.6">
    <!-- HEIC support library - using multiple CDN sources for reliability -->
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    <script>
        // Fallback check for heic2any library
        if (typeof heic2any === 'undefined') {
            console.warn('heic2any library failed to load from primary CDN, trying fallback...');
            var script = document.createElement('script');
            script.src = 'https://unpkg.com/heic2any@0.0.4/dist/heic2any.min.js';
            script.onload = function() {
                console.log('heic2any loaded successfully from fallback CDN');
            };
            script.onerror = function() {
                console.error('Failed to load heic2any from both CDNs');
            };
            document.head.appendChild(script);
        } else {
            console.log('heic2any library loaded successfully from primary CDN');
        }
    </script>
</head>
<body>
    <div class="container">
        <!-- Language Switcher -->
        <div class="language-switcher">
            <button id="langToggle" class="lang-btn">
                <span data-en="üá∫üá∏ EN" data-zh="üá∫üá∏ EN">üá∫üá∏ EN</span>
            </button>
        </div>
        
        <h1 data-en="vPrompt - Prompt Generator" data-zh="vPrompt - ÊèêÁ§∫Ë©ûÁîüÊàêÂô®">vPrompt - Prompt Generator</h1>
        <form method="POST" enctype="multipart/form-data" id="promptForm">
            <div class="form-grid">
                <!-- Row 1 -->
                <div class="form-card">
                    <h3 data-en="üéØ Basic Settings" data-zh="üéØ Âü∫Êú¨Ë®≠ÂÆö">üéØ Basic Settings</h3>
                    <div class="form-group">
                        <label data-en="Prompt Type:" data-zh="ÊèêÁ§∫Ë©ûÈ°ûÂûãÔºö">Prompt Type:</label>
                        <select name="prompt_type">
                            <option value="image" {% if prompt_type == 'image' %}selected{% endif %} data-en="Image" data-zh="ÂúñÁâá">Image</option>
                            <option value="video" {% if prompt_type == 'video' %}selected{% endif %} data-en="Video" data-zh="ÂΩ±Áâá">Video</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-en="Language:" data-zh="Ë™ûË®ÄÔºö">Language:</label>
                        <select name="output_lang">
                            <option value="en" {% if output_lang == 'en' %}selected{% endif %} data-en="English" data-zh="Ëã±Ë™û">English</option>
                            <option value="zh-tw" {% if output_lang == 'zh-tw' or output_lang == 'zh-TW' %}selected{% endif %} data-en="Traditional Chinese" data-zh="ÁπÅÈ´î‰∏≠Êñá">Traditional Chinese</option>
                            <option value="zh-cn" {% if output_lang == 'zh-cn' or output_lang == 'zh-CN' %}selected{% endif %} data-en="Simplified Chinese" data-zh="Á∞°È´î‰∏≠Êñá">Simplified Chinese</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-en="Time:" data-zh="ÊôÇÈñìÔºö">Time:</label>
                        <div class="time-input-container">
                            <input type="checkbox" id="useTimeCheckbox">
                            <label for="useTimeCheckbox" style="margin-left:6px;">Use Time</label>
                            <input type="time" name="time" min="00:00" max="23:59" value="{{ time }}" id="timeInput" style="margin-left:12px;">
                        </div>
                        <input type="hidden" name="bypass_time" id="bypassTimeFlag" value="true">
                    </div>
                </div>

                <div class="form-card">
                    <h3 data-en="üì∏ Image Upload" data-zh="üì∏ ÂúñÁâá‰∏äÂÇ≥">üì∏ Image Upload</h3>
                    <div class="form-group">
                        <label data-en="Upload Image:" data-zh="‰∏äÂÇ≥ÂúñÁâáÔºö">Upload Image:</label>
                        <div class="drop-zone" id="dropZone">
                            <div class="drop-zone-content" id="dropZoneContent">
                                <div class="drop-zone-icon">üìÅ</div>
                                <div class="drop-zone-text">
                                    <p><strong data-en="Drag and drop image here" data-zh="ÊãñÊîæÂúñÁâáËá≥Ê≠§Ëôï">Drag and drop image here</strong></p>
                                    <p data-en="or " data-zh="Êàñ ">or <span class="drop-zone-browse" data-en="click to browse" data-zh="ÈªûÊìäÁÄèË¶Ω">click to browse</span></p>
                                    <p class="drop-zone-formats" data-en="Supports PNG, JPG, JPEG, GIF, HEIC" data-zh="ÊîØÊè¥ PNG„ÄÅJPG„ÄÅJPEG„ÄÅGIF„ÄÅHEIC">Supports PNG, JPG, JPEG, GIF, HEIC</p>
                                </div>
                            </div>
                            <div class="drop-zone-preview" id="dropZonePreview" style="display:none;">
                                <img id="previewImage" src="" alt="Preview Image">
                                <div class="preview-overlay">
                                    <div class="preview-info" id="previewInfo"></div>
                                    <button type="button" class="remove-image" id="removeImage">√ó</button>
                                </div>
                            </div>
                        </div>
                        <input type="file" name="image" id="fileInput" accept="image/*,.heic,.heif" style="display:none;">
                    </div>
                </div>

                <div class="form-card">
                    <h3 data-en="üé≠ Scene & Character" data-zh="üé≠ Â†¥ÊôØËàáËßíËâ≤">üé≠ Scene & Character</h3>
                    <div class="form-group">
                        <label data-en="Scene:" data-zh="Â†¥ÊôØÔºö">Scene:</label>
                        <select name="scene" id="sceneSelect">
                            <option value="Êà∂Â§ñ" {% if scene == 'Êà∂Â§ñ' %}selected{% endif %} data-en="Outdoor" data-zh="Êà∂Â§ñ">Outdoor</option>
                            <option value="ÂÆ§ÂÖß" {% if scene == 'ÂÆ§ÂÖß' %}selected{% endif %} data-en="Indoor" data-zh="ÂÆ§ÂÖß">Indoor</option>
                            <option value="ÂÖ∂ÂÆÉ" {% if scene == 'ÂÖ∂ÂÆÉ' or not scene %}selected{% endif %} data-en="Other" data-zh="ÂÖ∂ÂÆÉ">Other</option>
                        </select>
                        <input type="text" name="custom_scene" id="customSceneInput" data-en-placeholder="e.g.: Forest, Beach, Cafe, Office..." data-zh-placeholder="‰æãÂ¶ÇÔºöÊ£ÆÊûó„ÄÅÊµ∑ÈÇä„ÄÅÂíñÂï°Âª≥„ÄÅËæ¶ÂÖ¨ÂÆ§..." placeholder="e.g.: Forest, Beach, Cafe, Office..." value="{{ custom_scene }}">
                    </div>
                    <div class="form-group">
                        <label data-en="Character:" data-zh="‰∏ªËßíÔºö">Character:</label>
                        <select name="character" id="characterSelect">
                            <option value="Áî∑" {% if character == 'Áî∑' %}selected{% endif %} data-en="Man" data-zh="Áî∑">Man</option>
                            <option value="Áî∑Â≠©" {% if character == 'Áî∑Â≠©' %}selected{% endif %} data-en="Boy" data-zh="Áî∑Â≠©">Boy</option>
                            <option value="ËÄÅ‰∫∫ÔºàÁî∑Ôºâ" {% if character == 'ËÄÅ‰∫∫ÔºàÁî∑Ôºâ' %}selected{% endif %} data-en="Elderly Man" data-zh="ËÄÅ‰∫∫ÔºàÁî∑Ôºâ">Elderly Man</option>
                            <option value="Â•≥" {% if character == 'Â•≥' %}selected{% endif %} data-en="Woman" data-zh="Â•≥">Woman</option>
                            <option value="Â•≥Â≠©" {% if character == 'Â•≥Â≠©' %}selected{% endif %} data-en="Girl" data-zh="Â•≥Â≠©">Girl</option>
                            <option value="ËÄÅ‰∫∫ÔºàÂ•≥Ôºâ" {% if character == 'ËÄÅ‰∫∫ÔºàÂ•≥Ôºâ' %}selected{% endif %} data-en="Elderly Woman" data-zh="ËÄÅ‰∫∫ÔºàÂ•≥Ôºâ">Elderly Woman</option>
                            <option value="ÂÖ∂ÂÆÉ" {% if character == 'ÂÖ∂ÂÆÉ' or not character %}selected{% endif %} data-en="Other" data-zh="ÂÖ∂ÂÆÉ">Other</option>
                        </select>
                        <input type="text" name="custom_character" id="customCharacterInput" data-en-placeholder="e.g.: Couple, Photographer, Student, Businessman, Artist..." data-zh-placeholder="‰æãÂ¶ÇÔºöÊÉÖ‰æ∂„ÄÅÊîùÂΩ±Â∏´„ÄÅÂ≠∏Áîü„ÄÅÂïÜ‰∫∫„ÄÅËóùË°ìÂÆ∂„ÄÅ..." placeholder="e.g.: Couple, Photographer, Student, Businessman, Artist..." value="{{ custom_character }}">
                    </div>
                </div>

                <!-- Row 2 -->
                <div class="form-card">
                    <h3 data-en="‚úçÔ∏è Description" data-zh="‚úçÔ∏è ÊèèËø∞ÂÖßÂÆπ">‚úçÔ∏è Description</h3>
                    <div class="form-group">
                        <label data-en="Share your thoughts:" data-zh="ÊïÖ‰∫ãÊèèËø∞Ôºö">Share your thoughts:</label>
                        <textarea name="extra_desc" data-en-placeholder="Describe style, mood, action, camera movement, angle, etc... e.g.: Tracking shot, warm sunlight, vintage style, happy expression, low angle shot" data-zh-placeholder="ÊèèËø∞È¢®Ê†º„ÄÅÊÉÖÁ∑í„ÄÅÂãï‰Ωú„ÄÅÈÅãÈè°„ÄÅËßíÂ∫¶Á≠â... ‰æãÂ¶ÇÔºöËøΩËπ§Èè°È†≠„ÄÅÊ∫´ÊöñÁöÑÈôΩÂÖâ„ÄÅÂæ©Âè§È¢®Ê†º„ÄÅÂø´Ê®ÇÁöÑË°®ÊÉÖ„ÄÅ‰ΩéËßíÂ∫¶ÊãçÊîù" placeholder="Describe style, mood, action, camera movement, angle, etc... e.g.: Tracking shot, warm sunlight, vintage style, happy expression, low angle shot" rows="8" style="font-family:monospace;font-size:0.75em;">{{ extra_desc }}</textarea>
                    </div>
                </div>

                <div class="form-card">
                    <h3 data-en="‚öôÔ∏è Generation Options" data-zh="‚öôÔ∏è ÁîüÊàêÈÅ∏È†Ö">‚öôÔ∏è Generation Options</h3>
                    <div class="option-group">
                        <label class="option-label">
                            <input type="checkbox" name="creative_mode" id="creativeMode" value="true" {% if creative_mode %}checked{% endif %}>
                            <span class="option-text">
                                <span class="option-title" data-en="üé® Creative Mode" data-zh="üé® ÂâµÊÑèÊ®°Âºè">üé® Creative Mode</span>
                                <span class="option-desc" data-en="Generate more artistic and imaginative prompts" data-zh="ÁîüÊàêÊõ¥ÂÖ∑ËóùË°ìÊÄßÂíåÊÉ≥ÂÉèÂäõÁöÑÊèêÁ§∫Ë©û">Generate more artistic and imaginative prompts</span>
                            </span>
                        </label>
                        <label class="option-label">
                            <input type="checkbox" name="include_ending" id="includeEnding" value="true" {% if include_ending %}checked{% endif %}>
                            <span class="option-text">
                                <span class="option-title" data-en="üé¨ Scene Transition" data-zh="üé¨ Â†¥ÊôØËΩâÂ†¥">üé¨ Scene Transition</span>
                                <span class="option-desc" data-en="Add cinematic transitions and endings" data-zh="Âä†ÂÖ•ÈõªÂΩ±ËΩâÂ†¥ÂíåÁµêÂ∞æ">Add cinematic transitions and endings</span>
                            </span>
                        </label>
                        <label class="option-label">
                            <input type="checkbox" name="multiple_scenes" id="multipleScenes" value="true" {% if multiple_scenes %}checked{% endif %}>
                            <span class="option-text">
                                <span class="option-title" data-en="üé≠ Multiple Scenes" data-zh="üé≠ Â§öÂÄãÂ†¥ÊôØ">üé≠ Multiple Scenes</span>
                                <span class="option-desc" data-en="Create a sequence of connected scenes" data-zh="ÂâµÂª∫Â§öÂÄãÈÄ£Á∫åÂ†¥ÊôØÂ∫èÂàó">Create a sequence of connected scenes</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="form-card">
                    <h3 data-en="üöÄ Generate" data-zh="üöÄ ÁîüÊàê">üöÄ Generate</h3>
                    <div class="tip">
                        <strong>üí° <span data-en="Tip:" data-zh="ÊèêÁ§∫Ôºö">Tip:</span></strong>
                        <span data-en="Even without uploading an image, the system will generate rich prompts based on your selected scene, character, time, and additional description!" data-zh="Âç≥‰ΩøÊ≤íÊúâ‰∏äÂÇ≥ÂúñÁâáÔºåÁ≥ªÁµ±‰πüÊúÉÊ†πÊìöÊÇ®ÈÅ∏ÊìáÁöÑÂ†¥ÊôØ„ÄÅ‰∏ªËßí„ÄÅÊôÇÈñìÂíåÈ°çÂ§ñÊèèËø∞‰æÜÁîüÊàêË±êÂØåÁöÑÊèêÁ§∫Ë©ûÔºÅ">Even without uploading an image, the system will generate rich prompts based on your selected scene, character, time, and additional description!</span>
                    </div>
                    
                    <!-- Seed Options - Hidden by default, Use Random Seed enabled -->
                    <div class="form-group" style="margin-top: 16px; display: none;">
                        <label class="option-label">
                            <input type="checkbox" id="useRandomSeed" checked>
                            <span class="option-text">
                                <span class="option-title" data-en="üé≤ Use Random Seed" data-zh="üé≤ ‰ΩøÁî®Èö®Ê©üÁ®ÆÂ≠ê">üé≤ Use Random Seed</span>
                                <span class="option-desc" data-en="Generate with random seed for varied results" data-zh="‰ΩøÁî®Èö®Ê©üÁ®ÆÂ≠êÁîüÊàêÂ§öÊ®£ÁµêÊûú">Generate with random seed for varied results</span>
                            </span>
                        </label>
                        <div id="seedInputContainer" style="margin-top: 8px; display: none; padding: 12px; background-color: #f8f9fa; border-radius: 6px; border-left: 4px solid #6366f1;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <span style="font-size: 14px; font-weight: 500; color: #6366f1;">üéØ</span>
                                <label for="seedInput" style="font-size: 13px; font-weight: 500; color: #374151; margin: 0;" data-en="Custom Seed Value:" data-zh="Ëá™Ë®ÇÁ®ÆÂ≠êÂÄºÔºö">Custom Seed Value:</label>
                            </div>
                            <input type="number" id="seedInput" name="seed" placeholder="Enter seed (0-4294967295)" title="Enter a seed value (0-4294967295) for reproducible results" style="width: 100%; max-width: 200px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px;" min="0" max="4294967295">
                            <div style="font-size: 11px; color: #6b7280; margin-top: 4px;" data-en="Use the same seed to generate identical results" data-zh="‰ΩøÁî®Áõ∏ÂêåÁ®ÆÂ≠êÂèØÁîüÊàêÁõ∏ÂêåÁµêÊûú">Use the same seed to generate identical results</div>
                        </div>
                    </div>
                    
                    <div style="display:flex;align-items:center;gap:12px;margin-top:16px;">
                        <button type="submit" data-en="Generate Prompt" data-zh="ÁîüÊàêÊèêÁ§∫Ë©û">Generate Prompt</button>
                    </div>
                </div>
            </div>
        </form>
        
        <!-- Loading indicator -->
        <div id="loadingIndicator" style="display: none; text-align: center; padding: 20px; margin: 20px 0; background-color: #f8f9fa; border-radius: 8px; border: 2px dashed #6366f1;">
            <span class="loading-hourglass" style="font-size: 32px; margin-bottom: 10px; display: inline-block;">‚è≥</span>
            <div style="font-size: 16px; font-weight: 500; color: #6366f1;" data-en="Generating your prompt..." data-zh="Ê≠£Âú®ÁîüÊàêÊÇ®ÁöÑÊèêÁ§∫Ë©û...">Generating your prompt...</div>
            <div style="font-size: 14px; color: #666; margin-top: 5px;" data-en="Please wait while AI analyzes and creates your content..." data-zh="Ë´ãÁ®çÂÄôÔºåAI Ê≠£Âú®ÂàÜÊûê‰∏¶ÂâµÂª∫ÊÇ®ÁöÑÂÖßÂÆπ...">Please wait while AI analyzes and creates your content...</div>
        </div>
        
        <hr>
        <!-- Results container (AJAX will replace this inner HTML) -->
        <div id="resultsContainer" data-area>
            {% include '_results.html' %}
        </div>


    </div>
    
    <!-- Image Modal -->
    <div id="imageModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" onclick="closeImageModal()">&times;</span>
            <div class="modal-toolbar">
                <button class="modal-download-btn" onclick="downloadModalImage()" title="Download Image">
                    üì• Download
                </button>
            </div>
            <img id="modalImage" src="" alt="Generated image">
            <div id="modalCaption"></div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    <script src="/static/script.js"></script>
</body>
</html>
